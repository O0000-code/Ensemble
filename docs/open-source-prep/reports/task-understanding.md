# Ensemble 开源发布前代码质量检查 - 任务理解文档

## 一、任务背景

Ensemble 是一个 macOS 桌面应用，用于管理 Claude Code 的 Skill/MCP 配置。项目开发已完成，现需进行开源发布前的代码质量检查和清理。

## 二、任务范围

**项目路径**: `/Users/bo/Documents/Development/Ensemble/Ensemble2`

**技术栈**:
- 前端: React 18 + TypeScript 5 + Tailwind CSS 4
- 后端: Tauri 2.0 (Rust)
- 状态管理: Zustand

## 三、需要完成的工作

### 3.1 检查并移除调试代码
- 搜索所有 `console.log`、`console.warn`、`console.error`
- **判断标准**:
  - 应保留: 有意义的错误处理、用户操作反馈、关键业务日志
  - 应移除: 纯调试用途、开发时临时添加的、打印变量值的
- **执行原则**: 保守处理，不确定时保留

### 3.2 检查敏感信息
- 搜索可能的 API Key、密码
- 检查硬编码路径（如 `/Users/xxx/`）
- **执行原则**: 只报告，不随意修改可能影响功能的代码

### 3.3 运行代码检查工具
- 前端: 检查 ESLint 配置，如有则运行
- Rust: 运行 `cargo clippy`
- 收集所有 warning 和建议

### 3.4 检查未使用的依赖
- 前端: 分析 `package.json`
- Rust: 分析 `Cargo.toml`

## 四、核心约束（极其重要）

### 4.1 保守原则
1. **删除必须保守** - 只删除明确是调试用途且不影响任何功能的代码
2. **不确定时保留** - 任何存疑的代码都应保留并在报告中说明
3. **功能优先** - 绝不能因为清理导致任何功能异常
4. **样式完整** - 不能影响任何 UI 样式

### 4.2 判断依据
对于 console 语句，以下情况应**保留**:
- 在 catch 块中的错误日志
- 标记为 TODO/FIXME 的日志
- 涉及关键业务逻辑的日志
- API 调用失败的日志
- 文件操作错误的日志

以下情况可以**移除**:
- 单纯打印变量值用于调试
- 临时性的调试输出
- 被注释掉的 console 语句
- "test"、"debug"、"here" 等明显调试标记

## 五、输出要求

创建报告文件: `docs/open-source-prep/reports/batch1-code-quality.md`

报告内容:
1. 所有发现的问题列表
2. 已修复问题的详细说明
3. 需要人工判断的问题及建议
4. 代码检查工具的完整输出

## 六、执行策略

采用多阶段、多 SubAgent 的执行方式:

1. **调查阶段**: 并行 SubAgent 分别调查不同方面
2. **分析阶段**: 汇总结果，制定具体修改计划
3. **执行阶段**: 谨慎执行已确认安全的修改
4. **验证阶段**: 编译测试，确保功能正常
5. **报告阶段**: 生成最终报告

## 七、成功标准

1. 所有调试代码被正确识别和处理
2. 无敏感信息泄露风险
3. 代码检查工具无严重警告
4. 项目可正常编译运行
5. 无任何功能或样式受损
